
# Topic Mapping Interface - API doc [![CC BY-NC 4.0][cc-by-nc-shield]][cc-by-nc]

The Topic Mapping Interface script and stylesheet bundles are located in [`app/dist`](../app/dist).

The stylesheet contains the styles of all page modules as well as default styles for the page overall.
Check [this section](#styles) for more details.

The script sets up `tMap`, the top level library object for interacting with the Topic Map interface and its modules.

- [Page Layout Management](#page-manager)
- [Data Management](#data-manager)
- [State Management](#state-manager)
- [Visualisation Modules](#visualisation-modules)
    - [Bubble Topic Map](#bubble-topic-map)
    - [Wordcloud](#wordcloud)
    - [Trend Chart](#trend-chart)
    - [Bar Chart](#bar-chart)
    - [Line Chart](#line-chart)
- [HTML Panel Modules](#html-panel-modules)
    - [Document Table](#document-table)
    - [Document Viewer](#document-viewer)
- [Control Modules](#control-modules)
    - [Floating Menu](#floating-menu)
    - [Search Box](#search-box)
    - [Dropdown Filter](#dropdown-filter)
- [Other Utilities](#other-utilities)
- [Styles](#styles)


## Page Manager

The page manager sets a grid on the HTML page that will automatically position and size containers for the modules.

It is instantiated as follow:
```javascript
let PM = tMap.PageManager(container, layout, controls, header, footer, minWidth, minHeight);
```
- `container` is a string selector for the DOM element that will contain all modules, e.g. `'div#app'`. It defaults to `'body'`.
- `layout` is a string specifying the desired page layout. It defaults to `'A'` (one panel taking the whole space).
- `controls` is a string specifying the desired page controls and there position. It defaults to `''` (no controls).
- `header` and `footer` are the string selectors for the DOM element acting as page header and footer. Their height will be deducted when computing the page size. They both default to `''` (no element).
- `minWidth` and `minHeight` are integers used to set the page minimum size. They both default to `600`. 

For more detail about the layout and controls parameters, check [this page](./PageLayouts.md).

The Page Manager instance created, `PM`, is an object listing the selectors and sizes of each panels generated. For example, if you choose to generate layout with 3 panels and 2 controls, `PM` will contain 5 attributes: `panel1`, `panel2`, `panel3`, `control1`, and `control2`. Each of these attributes will have 3 attributes of their own: `c` the string selector for the container created, `w` the width available for it, and `h` the height.
```javascript
PM.panel1.c // --> the selector for panel1 container, typically 'div#panel1'
PM.panel1.w // --> the width available for panel1, e.g. 500
PM.panel1.h // --> the height available for panel1, e.g. 300
```

### Page Responsivity

The Page Manager instance also has a `watch` function available:
```javascript
PM.watch({
    panel: module
})
```

This provides a map between the panels' names and the interface modules. During window resizing, Page Manager will recompute the panels' sizes and automatically updates the modules.


## Data Manager

The data manager facilitates the loading and interaction with the data files generated by the Topic Mapping Pipeline.

It is instantiated as follow:
```javascript
let DM = tMap.DataManager();
```

You can then access the data management features from `DM`.

- [Processing Data](#processing-data)
- [Map features](#map-features)
- [Document List features](#document-list-features)
- [Distribution features](#distribution-features)
- [Trend features](#trend-features)
- [Search features](#search-features)
- [Statistics features](#statistics-features)

### Processing Data

#### `DataManager.loadDataFromUrls(urls)`

Loads data from the urls provided. The urls must be given in a object:
```javascript
DM.loadDataFromUrls({name1: url1, name2: url2});
``` 
Returns a promise object with a list of the loaded data as parameter, e.g.:
```javascript
[{name:name1,data:data1},{name:name2,data:data2}]
``` 

JSON and CSV files will be automatically parsed. Other formats will simply be read as a regular string.

#### `DataManager.processData(dataArray)`

Gets a setof data in the format `[{name,data}]` (i.e. generated by `.loadDataFromUrls`) and attaches the data to the data manager. For example:
```javascript
DM.processData([{name:name1,data:data1},{name:name2,data:data2}]);
``` 
Will be attached to `DM` like so:
```javascript
DM.data.name1 // -> data1
DM.data.name2 // -> data2
```

#### `DataManager.loadAndProcessDataFromUrls(urls)`

Combines `.loadDataFromUrls` and `.processData` together. Takes a set of urls as input, attaches the data to the data manager instance, and returns a promise object (with no parameters):
```javascript
DM.loadAndProcessDataFromUrls({name1: url1, name2: url2}).then(()=>{
    console.log(DM.data.name1); // -> data1
    console.log(DM.data.name2); // -> data2
});
```

#### Important Notes

While any url and data name can be passed to `.loadAndProcessDataFromUrls`, other features of the data manager expect specific names and data structures:
- `mainMap` (and `subMaps`): the main map (and set of sub maps) JSON file(s) generated by the Topic Mapping Pipeline's mapping modules;
- `mainModel` (and `subModel`): the main model (and sub model) JSON file(s) generated by the Topic Mapping Pipeline's export model module;
- `distribution`: any distribution JSON file generated by the Topic Mapping Pipeline's topic distribution module:
    - while `distribution` remains the default name, you use custom names to load more than one distribution JSON file;
    - you can then specify these names in the [Distribution features](#distribution-features) methods;
- `trend`: a date distribution JSON file generated by the Topic Mapping Pipeline's topic distribution module;
- `labelsIndex`: the labels index JSON file generated by the Topic Mapping Pipeline's label indexing module.

These features provide shortcut to accessing and processing the data files to fit with the page's modules.

### Map features

These features let you access and interact with the data from `mainMap` and `subMaps`.

#### `DataManager.setSubMap(topicId)`

Given a the id of a topic from the main map, gets the sub map data attached to it and saves it to the `subMap` data attribute of the manager (for later access). Will throw and error if `subMaps` was not loaded or if no sub map can be found with this main topic id.
```javascript
DM.setSubMap('2');
console.log(DM.data.subMap); // -> sub map data assigned to main topic with id '2'
```

#### `DataManager.getSubMap([topicId])`

Same as `.setSubMap` but also returns the sub map data. `topicId` is optional here. If unspecified, the function will return the sub map data previously saved. If no sub map was previously set and no topic id is provided, the function will throw an error. The function can also throw errors from `.setSubMap` by proxy.
```javascript
let map = DM.getSubMap('2');
console.log(map); // -> sub map data assigned to main topic with id '2'

DM.setSubMap('5');
let map = DM.getSubMap();
console.log(map); // -> sub map data assigned to main topic with id '5'
```

#### `DataManager.getTopicMainMap(topicId)`

Returns the data (labels, position, etc.) for the topic with id `topicId` from the main map. Will throw an error if `mainMap` was not loaded or if no topic can be found with the specified id.
```javascript
let t = DM.getTopicMainMap('3');
console.log(t); // -> topic data for topic with id '3' in main map
```

#### `DataManager.getTopicSubMap(topicId)`

Returns the data (labels, position, etc.) for the topic with id `topicId` from the sub map previously saved with `setSubMap`. Will throw an error if no sub map was previously set or if no topic can be found with the specified id.
```javascript
let t = DM.getTopicSubMap('1');
console.log(t); // -> topic data for topic with id '1' in sub map
```

### Document List features

These features let you access and interact with the document lists inside the `mainModel` and `subModel`.

#### `DataManager.setTableRowsMainTopic(topicId)`

Given a topic id from the main model, will set the data attribute `tableRows` to the topic's top documents. If no topic is found `tableRows` is set to an empty list. If `mainModel` was not loaded, the function will throw an error.
```javascript
DM.setTableRowsMainTopic('4');
console.log(DM.data.tableRows); // -> the list of top documents for topic '4' in the main model
``` 

#### `DataManager.setTableRowsSubTopic(topicId)`

Same as above but with topics from the sub model.
```javascript
DM.setTableRowsSubTopic('6');
console.log(DM.data.tableRows); // -> the list of top documents for topic '6' in the sub model
``` 

#### `DataManager.getTableRows([number [, filter]])`

Returns the list of documents saved in `tableRows` with the methods above. `number` is optional and lets you crop the list to the top x document entries, its default value is `10`. `filter` is optional too and lets you provide a function to filter the documents (before croping the list), its default value is `()=>true` (no filter). The function will throw an error if `tableRows` has not been set.
```javascript
DM.setTableRowsMainTopic('4');
let d = DM.getTableRows(30, d=>d.published);
console.log(d); // -> list of the top 30 documents, that were "published", from topic '4' in the main model 
```

#### `DataManager.getDocument(docId)`

Given a document id, returns the associated document data saved in `tableRows`. The function will throw an error if `tableRows` has not been set or is empty, or if no document with such id can be found. 
```javascript
DM.setTableRowsMainTopic('4');
let d = DM.getDocument('43');
console.log(d); // -> data for the document '43', which is in the top documents for topic '4' in the main model.
```

### Distribution features

These features let you access and interact with the `distribution` data. This type of data is generated by the Topic Mapping Pipeline's topic distribution module. Note that date distributions have [separate features](#trend-features).

#### `DataManager.getDistributionLabels([textTransform [, customDistributionName]])`

Returns the list of the distribution's fields labels. `textTransform` is an optional function that lets you transform the labels' text for display, it defaults to `d=>d` (identity function). `customDistributionName` is an optional string that lets you specify which distribution to look at, it defaults to `distribution`. The returned list will be in the format: `[{value, text}, ...]` where `value` is the original label value and `text` is the transformed value. Note that this method will go over all topics to get all fields, but one topic is not guaranteed to have entries for all fields. This function will throw an error if `customDistributionName` has not been set.
```javascript
let l = DM.getDistributionLabels(t=>`Category ${t}`);
console.log(l); // -> list of fields, e.g. [{value:'A', text:'Category A'},{value:'B', text:'Category B'},{value:'C', text:'Category C'}]
```

#### `DataManager.getMainTopicsDistrib(fieldName [, customDistributionName])`

Returns the topic distribution of main topics, given a field name. `customDistributionName` is an optional string that lets you specify which distribution to look at, it defaults to `distribution`. This function will throw an error if `customDistributionName` has not been set, if the distribution does not have main topics, or if the field name provided is not part of the distribution.
```javascript
let d = DM.getMainTopicsDistrib('A');
console.log(d); // -> main topic distribution for field A, e.g. [{topicId: '0', value: 32.0}, {topicId: '1', value: 10.0}, ...]
```

#### `DataManager.getSubTopicsDistrib(fieldName [, customDistributionName])`

Same as above for sub topics.

#### `DataManager.getMainTopicsDistribNormPerTopic(fieldName [, customDistributionName])`

Returns the topic distribution of main topics, given a field name. `customDistributionName` is an optional string that lets you specify which distribution to look at, it defaults to `distribution`. The values returned are normalised using the total distribution value for each topic: `v_final = v_topic_field / total_topic`. This function will throw an error if `customDistributionName` has not been set, if the distribution does not have main topics, or if the field name provided is not part of the distribution.
```javascript
let d = DM.getMainTopicsDistribNormPerTopic('A');
console.log(d); // -> main topic distribution for field A normalised per topic (across the other fields), e.g. [{topicId: '0', value: 0.3}, {topicId: '1', value: 0.6}, ...]
```

#### `DataManager.getSubTopicsDistribNormPerTopic(fieldName [, customDistributionName])`

Same as above for sub topics.

#### `DataManager.getMainTopicsDistribNormPerField(fieldName [, customDistributionName])`

Returns the topic distribution of main topics, given a field name. `customDistributionName` is an optional string that lets you specify which distribution to look at, it defaults to `distribution`. The values returned are normalised using the total distribution value for each field: `v_final = v_topic_field / total_field`. This function will throw an error if `customDistributionName` has not been set, if the distribution does not have main topics, or if the field name provided is not part of the distribution.
```javascript
let d = DM.getMainTopicsDistribNormPerField('A');
console.log(d); // -> main topic distribution for field A normalised across the topics, e.g. [{topicId: '0', value: 0.063}, {topicId: '1', value: 0.13}, ...]
```

#### `DataManager.getSubTopicsDistribNormPerField(fieldName [, customDistributionName])`

Same as above for sub topics.

#### `DataManager.getMainTopicDistribEntry(topicId [, customDistributionName])`

Returns the distribution entry for the topic with the specified id. `customDistributionName` is an optional string that lets you specify which distribution to look at, it defaults to `distribution`. This function will throw an error if `customDistributionName` has not been set, if the distribution does not have main topics, or if the topic id provided is not found.
```javascript
let d = DM.getMainTopicDistribEntry('1');
console.log(d); // -> distribution entry for main topic '1', e.g. [{key: 'A', value: 10.0}, {key: 'B', value: 5.0}, ...]
```

#### `DataManager.getSubTopicDistribEntry(topicId [, customDistributionName])`

Same as above for sub topics.
  
#### `DataManager.getMainTopicDistribEntryNorm(topicId [, customDistributionName])`

Returns the distribution entry for the topic with the specified id. `customDistributionName` is an optional string that lets you specify which distribution to look at, it defaults to `distribution`.  Each value returned will be normalised by the total weight for this topic. This function will throw an error if `customDistributionName` has not been set, if the distribution does not have main topics, or if the topic id provided is not found.
```javascript
let d = DM.getMainTopicDistribEntryNorm('1');
console.log(d); // -> distribution entry for main topic '1' normalised, e.g. [{key: 'A', value: 0.6}, {key: 'B', value: 0.3}, ...]
```

#### `DataManager.getSubTopicDistribEntry(topicId [, customDistributionName])`

Same as above for sub topics.

#### `DataManager.getDistributionDomainData([fieldNames [, customDistributionName]])`

Returns the data associated to domain fields of the distribution. `fieldNames` is an optional list of fields to filter, it defaults to `[]` which will return all field entries. `customDistributionName` is an optional string that lets you specify which distribution to look at, it defaults to `distribution`. This function will throw an error if `customDistributionName` has not been set, or if the distribution does not have domain data.
```javascript
let f = DM.getDistributionDomainData();
console.log(f); // -> {A:{dataKey1: 'value1A', dataKey2: 'value2A'}, B:{dataKey1: 'value1B', dataKey2: 'value2B'}, ...}
f = DM.getDistributionDomainData(['A','C']);
console.log(f); // -> {A:{dataKey1: 'value1A', dataKey2: 'value2A'}, C:{dataKey1: 'value1C', dataKey2: 'value2C'}}
```

### Trend features

These features let you access and interact with the `trend` data. This type of data is generated by the Topic Mapping Pipeline's topic distribution module, when applied on date fields. 

#### `DataManager.timeFormatConverter(inFormat, outFormat)`

Returns a function that converts date formats.
```javascript
let convert = DM.timeFormatConverter('%d/%m/%y', '%Y-%m');
console.log(convert('04/05/12')) // -> '2012-05'
```
Refer to [D3's documentation](https://github.com/d3/d3-time-format#locale_format) for more details about the format specification.

This function is particularly useful when trying to aggregate values by months or years. As such, it also has a duplicate name: `DataManager.getTrendSumByFunction(inFormat, outFormat)`.

It is also a duplicate of the [`.dateConverter` utility](#tmapdateconverterinformat-outformat), which is available without instantiating a Data Manager.

#### `DataManager.getMainTopicTrend(topicId [,sumBy [,timeRange]])`

Given the id of a main topic, returns the trend for this topic, in the format: `[{date, value}]`. `sumBy` is a optional function that lets you aggregate the distribution value by date, e.g. by month or by year, this function is essentially a date converter that `.timeFormatConverter` or `.getTrendSumByFunction` produce. `timeRange` is a optional range that lets you filter the distribution dates, this range is defined as a list of three strings: `[format, minDate, maxDate]`, `minDate` will be included and `maxDate` excluded.

This function will throw errors if: the trend data was not loaded; the trend data does not have main topics; the topic was not found; or the timeRange, if given, was not correct.

```javascript
let convert = DM.timeFormatConverter('%d/%m/%y', '%Y-%m');
let range = ['%d/%m/%y', '01/01/2012', '01/07/2012'];
let d = DM.getMainTopicTrend('1', convert, range);
console.log(d); // -> trend for the main topic '1', grouped by month, between January and June (both included)
```

#### `DataManager.getMainTopicTrend(topicId [,sumBy [,timeRange]])`

Same as above for sub topics.

#### `DataManager.getMaxTrend([sumBy])`

Returns the maximum value in the `trend` data, across all topics. The optional `sumBy` function lets you aggregate the maximum value by a specific time period (year, month, etc.).
```javascript
let convert = DM.timeFormatConverter('%d/%m/%y', '%Y-%m');
let maxValue = DM.getMaxTrend(convert);
console.log(maxValue); // -> maximum value of the trend, across all topics, by month
```

### Search features

These features let you access and interact with the `labelsIndex` data, enabling search functionalities.

#### `DataManager.setSearchTerm(string)`

Saves a string as the search term for later functions.
```javascript
DM.setSearchTerm('label1 label2; label3');
console.log(DM.data.searchTerm); // -> 'label1 label2; label3'
```

The search term can be composed of multiple labels, organised with logic operators:
- `and`, `+`, ` ` (space): connect labels with an `AND`;
- `or`, `*`, `;`: connect labels (or multiple labels connected by `AND`) with an `OR`;

If the search term comprises only one word, with space at the end of it, the future search functions will consider every labels containting this word as substring.

#### `DataManager.processWordInSearch(word [,searchValue [,append]])`

Allows you to safely process a word in a search string. If the word is not in the search, the function will append it to the end of the search string (with the `append` character which defaults to `;`). If the word is already in the search, the function will remove it. `searchValue` is optional (defaults to `null`), if not specified or set to `null`, the function will use the search term set by `.setSearchTerm` and update it. The function returns the new search string.
```javascript
let s = DM.processWordInSearch('word', 'search string', '-');
console.log(s); // -> 'search string- word'

let s = DM.processWordInSearch('search', 'search string');
console.log(s); // -> 'string'

DM.setSearchTerm('label1 label2; label3');
DM.processWordInSearch('label4');
console.log(DM.data.searchTerm); // -> 'label1 label2; label3; label4'
```

#### `DataManager.getDocIdsFromSearch()`

Returns the ids of documents matching the search term set with `.setSearchTerm` in the `labelsIndex` data. The function will throw an error if `labelsIndex` has not been set.
```javascript
DM.setSearchTerm('label1 label2; label3');
let docIds = DM.getDocIdsFromSearch();
console.log(docIds); // -> the list of document ids containing 'label1' and 'label2', or 'label3'

DM.setSearchTerm('lab');
let docIds = DM.getDocIdsFromSearch();
console.log(docIds); // -> the list of document ids containing 'label1', 'label2', 'label3', or 'laboratory' ...
```

#### `DataManager.getTopicIdsFromSearch()`

Returns two sets of ids for the main and sub topics matching the search term set with `.setSearchTerm` in the `labelsIndex` data. The function will throw an error if `labelsIndex` has not been set.
```javascript
DM.setSearchTerm('label1 label2; label3');
let {mainTopicIds, subTopicIds} = DM.getTopicIdsFromSearch();
console.log(mainTopicIds); // -> the list of main topic ids containing 'label1' and 'label2', or 'label3'
console.log(subTopicIds); // -> the list of sub topic ids containing 'label1' and 'label2', or 'label3'

DM.setSearchTerm('lab');
let {mainTopicIds, subTopicIds} = DM.getTopicIdsFromSearch();
console.log(mainTopicIds); // -> the list of main topic ids containing 'label1', 'label2', 'label3', or 'laboratory' ...
console.log(subTopicIds); // -> the list of sub topic ids containing 'label1', 'label2', 'label3', or 'laboratory' ...
```

#### `DataManager.getLabelsFromSearch()`

Returns the exact set of labels matching the search term set with `.setSearchTerm` in the `labelsIndex` data. The function will throw an error if `labelsIndex` has not been set.
```javascript
DM.setSearchTerm('label1 label2; label3');
let labels = DM.getLabelsFromSearch();
console.log(labels); // -> [label1, label2, label3]

DM.setSearchTerm('lab');
let labels = DM.getLabelsFromSearch();
console.log(labels); // -> ['label1', 'label2', 'label3', 'laboratory', ...]
```

#### `DataManager.getFromSearch()`

A wrapper function for `.getLabelsFromSearch`, `.getTopicIdsFromSearch`, and `.getDocIdsFromSearch`, returning a object comprising the results of these other function. The function will throw an error if `labelsIndex` has not been set.

```javascript
DM.setSearchTerm('label1 label2; label3');
let {labels, docs, topics} = DM.getFromSearch();
console.log(topics.mainTopicIds); // -> the list of main topic ids containing 'label1' and 'label2', or 'label3'
console.log(topics.subTopicIds); // -> the list of sub topic ids containing 'label1' and 'label2', or 'label3'
console.log(docIds); // -> the list of document ids containing 'label1' and 'label2', or 'label3'
console.log(labels); // -> [label1, label2, label3]
```

### Statistics Features

These features let you access the data related to models' statistics.

#### `DataManager.getMainModelMetadata()`

Returns the main model's metadata, e.g. numberof documents in total, number of documents unused for being too short, stop phrases and stop words, etc. . Will throw an error if the main model file was not loaded, or if the main model does not have metadata.
```javascript
console.log(DM.getMainModelMetadata()); // -> prints the main model metadata.
```

#### `DataManager.getSubModelMetadata()`

Same as above for the sub model metadata.
```javascript
console.log(DM.getSubModelMetadata()); // -> prints the sub model metadata.
```

#### `DataManager.getFinalMainLL()`

Returns the final log-likehood information for the main model, comprising of the total number of iterations (`nIter`) and the final log-likelihood value (`LL`). The function will throw an error if the main log-likelihood file was not loaded, of the total number of iteration or final log-likehood value are missing.  
```javascript
console.log(DM.getFinalMainLL()); // -> prints the main model log-likehood information, e.g. {nIter:2000,LL:-7.6906}.
```

#### `DataManager.getFinalSubLL()`

Same as above for the sub model log-likelihood.
```javascript
console.log(DM.getFinalSubLL()); // -> prints the sub model log-likehood information, e.g. {nIter:5000,LL:-4.897}.
```

#### `DataManager.getMainLLData()`

Returns the history data of the main model's log-likelihood, i.e. the log-likelihood values accross iterations. The data returned is a list, with each having the iteration number (`iter`) and the log-likelihood value (`LL`). The function will throw an error if the main model's log-likelihood file was not loaded, or if the file does not have entries.
```javascript
console.log(DM.getMainLLData()); // -> prints the main model log-likehood data, e.g. [{iter:10,LL:-13.987},{iter:20,LL:-12.5324},...].
```

#### `DataManager.getSubLLData()`

Same as above for the sub model log-likelihood.
```javascript
console.log(DM.getSubLLData()); // -> prints the main model log-likehood data, e.g. [{iter:10,LL:-18.4387},{iter:20,LL:-15.0043},...].
```


## State Manager

The state manager offers a centralised system to set and access the various state of the application, e.g. selected main topic, current search value, or selected distribution.

It is instantiated as follow:
```javascript
let SM = tMap.StateManager();
```

You can then access the state management methods from `SM`.

- [Setting/Accessing States](#states)
- [URL features](#url-features)

### States

There are currently six states controlled by the State Manager:
- `mainTopic`: the topic selected on a main map;
- `subTopic`: the topic selected on a sub map;
- `doc`: the document selected in a document table;
- `distrib`: the distribution field selected to set the maps' opacity;
- `date`: the date selected on a trend chart to filter documents; and
- `search`: the search string entered in the search box.

#### `StateManager.state(name [, value])`

If `value` is specified, lets you set it as the value for the state associated with `name`. If no `value` is given, returns the current value of the state associated with `name`. If no state can be found with `name`, the function will throw an error.
```javascript
SM.state('mainTopic', '20'); // -> set the currently selected topic on the main map to the topic with id '20'
SM.state('search', 'label1 label2'); // -> set the current search string to 'label1 label2'
SM.state('mainTopic'); // -> returns '20'
```

#### `StateManager.reset()`

Resets the state values to their default: `null`.
```javascript
SM.reset();
SM.state('mainTopic'); // -> returns null
```

### URL features

The State Managers includes features allowing you to build and parse URLs with the states' values embedded in them.

#### `StateManager.buildURL([customBase])`

Returns a URL string with the states' values embedded. `customBase` is an optional string letting you define your own domain and path.
```javascript
// page is at domain.com/page.html
SM.state('mainTopic', '20');
SM.state('search', 'label1 label2');
SM.state('doc', '34');
let url = SM.buildURL();
console.log(url); // -> https://domain.com/page.html?t=20&d=34&s=label1%20label2 

let url = SM.buildURL('domain.com/otherPage.html');
console.log(url); // -> https://domain.com/otherPage.html?t=20&d=34&s=label1%20label2 
```

#### `StateManager.parseURL()`

Parses the HTML document's URL and sets the states accordingly.
```javascript
// document URL : https://domain.com/page.html?t=20&d=34&s=label1%20label2
SM.parseURL();
console.log(SM.state('mainTopic')); // -> '20'
console.log(SM.state('search')); // -> 'label1 label2'
``` 


## Visualisation Modules

The visualisation modules are view panels with an SVG structure. They all share [the same base API](#visualisation-api). At this stage, the Topic Mapping Interface comprises the following visualisation modules:
- [Bubble Topic Map](#bubble-topic-map)
- [Wordcloud](#wordcloud)
- [Trend Chart](#trend-chart)
- [Bar Chart](#bar-chart)
- [Line Chart](#line-chart)

### Visualisation API

The visualisation modules are all built from the same base module, meaning that they share a common base API.

> Note that all of the functions below return the visualisation module itself, unless specified otherwise.
> This allows you to chain this functions.

#### `Visualisation.setWidth(value)`

Sets the width of the visualisation, and automatically adjust its internal elements.
```javascript
let v = tMap.someVisualisation();
v.setWidth(600); // -> the visualisation width to 600 px
```

#### `Visualisation.setHeight(value)`

Sets the height of the visualisation, and automatically adjust its internal elements.
```javascript
let v = tMap.someVisualisation();
v.setHeight(300); // -> the visualisation height to 300 px
```

#### `Visualisation.setSize(width, height)`

Sets the width and height of the visualisation, and automatically adjust its internal elements.
```javascript
let v = tMap.someVisualisation();
v.setSize(600,300); // -> the visualisation width to 600 px and height to 300 px
```

#### `Visualisation.setMargin(values)`

Sets the margins of the visualisation, and automatically adjust its internal elements. The margins are given as a list: `[top, bottom, left, right]`.
```javascript
let v = tMap.someVisualisation();
v.setMargin([10,20,30,10]); // -> the visualisation margins to 10px top, 20px bottom, 30px left, and 10px right
```

#### `Visualisation.toggleBorder([boolean])`

Toggles a border around the visualisation module. The `boolean` parameter lets you specify which state you want: `true` = on, and `false` = off. It is optional will default to the opposite of the visualisation current state. Note that the visualisation border is on by default.
```javascript
let v = tMap.someVisualisation(); // -> the visualisation border is on
v.toggleBorder(true); // -> turns on the visualisation border (no effect)
v.toggleBorder(false); // -> removes the visualisation border
v.toggleBorder(); // -> turns on the visualisation border
v.toggleBorder(); // -> turns off the visualisation border
```

#### `Visualisation.toggleButton(position [,text, callback])`

Toggles a button on the visualisation. Each visualisation module can have four buttons, each identified by a `position`: `'TL'` for the top-left corner, `'TR'` for the top-right corner, `'BL'` for the bottom-left corner, and `'BR'` for the bottom-right corner. To toggle a button on, you must specify its `text` and `callback` function too. To turn it off, just specify the `position`.
```javascript
let v = tMap.someVisualisation();
v.toggleButton('BL', 'Action', ()=>{console.log('action BL')}); // adds a button to the bottom-left corner, with text 'Action', that prints 'action BL' to the console.
v.toggleButton('BL'); // removes the button at the bottom-left corner.
```

#### `Visualisation.toggleTitle([text, [position]])`

Toggles a title on the visualisation. If `text` is specified, toggles the title on with this text, otherwise toggles the title off. `position` lets you choose where you want the title, either at the top `'T'` (default) or bottom `'B'` of the visualisation.
```javascript
let v = tMap.someVisualisation();
v.toggleTitle('Visualisation'); // -> puts 'Visualisation' as the top of the visualisation
v.toggleTitle('Visualisation', 'B'); // -> moves 'Visualisation' as the bottom of the visualisation
v.toggleTitle(); // -> removes 'Visualisation' from the visualisation
```

#### `Visualisation.addDefaultText(string [,scale [,blinking]])`

Puts a message, `string`, at the center of the visualisation. `scale` lets you specify the message size, defaults to 1. `blinking` lets you specify if you want the message to blink `true` or not `false` (default), for example when loading data.
```javascript
let v = tMap.someVisualisation();
v.addDefaultText('Loading data', 1.5, true); // -> large blinking text saying 'Loading data'
``` 
Note that any message printed this way will be automatically removed once the visualisation is rendered.


### Bubble Topic Map

The bubble map visualisation module renders data from `mainMap` and `subMaps` files, produced by the Topic Mapping Pipeline bubble map module.

A Bubble Map is instantiated using `tMap`'s `BubbleMap` function. Like most page modules, it takes three parameters: a DOM `container`, and initial `width` and `height`. These parameters are typically returned by the [Page Manager](#page-manager).
```javascript
let PM = tMap.PageManager(...);
let bubbleMap = tMap.BubbleMap(PM.panel1.c, PM.panel1.w, PM.panel1.h);
```

This module is built with [the visualisation API](#visualisation-api) and therefore has the same base methods.

> Note that all of the functions below return the visualisation module itself, unless specified otherwise.
> This allows you to chain this functions.

#### `BubbleMap.setBubbleClick(callback)`

Sets a callback for click events on the map's bubbles.
```javascript
bubbleMap.setBubbleClick((e,d)=>{console.log(d)}); // -> on bubble click print the bubble's datum
```

> Note that the callback has to follow D3 v6.0's callback signature:
> `callback(event, datum)`
> Check [D3 v6.0 migration guide](https://observablehq.com/@d3/d3v6-migration-guide#events) for more details

#### `BubbleMap.setTooltip(textFunction)`

Sets the function used to build the bubbles' tooltip text. If defined, this text function will be called with the bubble's datum as parameter. You can set this text function to `null` in order to disable the text tooltip.
```javascript
bubbleMap.setTooltip(d=>`Size: ${d.size}`); // bubbles' tooltip will print 'Size: 23.0' for example.
```

#### `BubbleMap.setTooltipChart(charFunction)`

Sets the function used to build the bubbles' tooltip chart. If defined, this chart function will be called with the tooltip's DOM container and the bubble's datum as parameter. You can set this chart function to `null` in order to disable the chart tooltip.
```javascript
let DM = tMap.DataManager();
bubbleMap.setTooltipChart((t,d)=>{
    tMap.HorizontalBarChart(t, 200, 100)
        .render(DM.getMainTopicDistribEntry(d.topicId));
}); // bubbles' tooltip include an horizontal bar chart showing the bubble's topic distribution.
```

#### `BubbleMap.setMinimumTextSize(size)`

Lets you set the minimum `size` the bubble's text can have. Note that the bubble will be scaled to fit inside the visualisation after being rendered, texts might appear larger/smaller than the value of `size`.
```javascript
bubbleMap.setMinimumTextSize(3); // bubbles' text can be no smaller than 3px (before map scaling).
```

#### `BubbleMap.render(dataset)`

Renders the bubble map using the provided `dataset`. This `dataset` can be accessed from the data manager, e.g. `DM.data.mainMap` or `DM.data.subMap`.
```javascript
bubbleMap.render(DM.data.mainMap); // renders the main topic map
bubbleMap.render(DM.getSubMap('2')); // renders the sub topic map for main topic '2'
```

#### `BubbleMap.selectBubble([topicId [,idAccessor]])`

If provided with topic id, will mark the associated bubble *selected* (using CSS class). All other bubbles are marked as not selected, i.e. only one bubble can be selected at a time. If `topicId` is not specified, or set to null, the function will unselect all bubbles. `idAccessor` lets you define how to access the topic id in the bubble map topic data, it defaults to `d=>d.topicId` which corresponds to how topic ids are stored in `mainMap` and `subMaps`.
```javascript
bubbleMap.selectBubble('2'); // bubble for topic '2' will be classed 'selected'
```

#### `BubbleMap.highlightBubbles([topicIds [,idAccessor]])`

Given a list of topic ids, will mark the associated bubbles as *highlighted* (using CSS class). Every other bubbles are marked as not highlighted. If `topicId` is not specified, or set to an empty list `[]`, the function will remove highlight for every bubbles. `idAccessor` lets you define how to access the topic id in the bubble map topic data, it defaults to `d=>d.topicId` which corresponds to how topic ids are stored in `mainMap` and `subMaps`.
```javascript
bubbleMap.selectBubble(['2','3','8','13']); // bubbles for topics '2','3','8', and '13' will be classed 'highlighted'
```

#### `BubbleMap.setBubblesOpacity(distributionData [,reset])`

Given a distribution (list of topic ids/keys and weights/values), will adjust the opacity of bubbles to reflect the weights. `reset` is an optional parameter that lets you reset all the opacities to `1` (`true`), it defaults to `false`.
```javascript
bubbleMap.setBubblesOpacity(DM.getMainTopicsDistrib('A')); // sets the opacity of all bubbles using the distribution of field 'A'
```

#### `BubbleMap.setOpacityScale([minValue [, clampRatio [, scaleType]]])`

Lets you adjust the opacity scale used with `.setBubblesOpacity`. `minValue` is minimum opacity value of the scale's range, it defaults to `0.2`. The maximum range value is always `1`. `clampRatio` is a multiplier applied on the maximum value of scale's domain, allowing you to lower or increase the threshold for maximum opacity, it defaults to `1` (no changes). `scaleType` lets you choose what type of scale to use, either `linear` (default) or `log`.
```javascript
bubbleMap.setOpacityScale(0.3, 0.9, 'log'); // use a scale range of [0.3,1], a scale domain of [0, 90% of the distribution maximum value], and a logarithmic scale.
```


### Wordcloud

The wordcloud visualisation module renders the label data from a specific topic in `mainMap`, `subMaps`, `mainModel`, and `subModel` files, produced by the Topic Mapping Pipeline bubble map and model export modules.

A Wordcloud is instantiated using `tMap`'s `WordCloud` function. Like most page modules, it takes three parameters: a DOM `container`, and initial `width` and `height`. These parameters are typically returned by the [Page Manager](#page-manager).
```javascript
let PM = tMap.PageManager(...);
let wordcloud = tMap.WordCloud(PM.panel3.c, PM.panel3.w, PM.panel3.h);
```

This module is built with [the visualisation API](#visualisation-api) and therefore has the same base methods.

> Note that all of the functions below return the visualisation module itself, unless specified otherwise.
> This allows you to chain this functions.

#### `WordCloud.setMaxNumberLabels(number)`

Sets the maximum number of labels rendered on the wordcloud. The default value is `50`.
```javascript
wordcloud.setMaxNumberLabels(30); // -> the wordcloud will render a maximum of 30 labels
```

#### `WordCloud.setTextSizeRange([min, max])`

Sets the range, in pixel, at which the labels will be rendered. The default range is set to `[10,25]`.
```javascript
wordcloud.setTextSizeRange([20, 30]); // -> the labels' size will be set between 20 and 30 pixel (small range) 
wordcloud.setTextSizeRange([10, 35]); // -> the labels' size will be set between 10 and 35 pixel (large range)
```

Note that this range is only relative (within labels), the wordcloud is scaled after each render to fit inside its SVG.

#### `WordCloud.setWordClick(callback)`

Sets the callback for click events on the wordcloud's labels.
```javascript
wordcloud.setWordClick((e,d)=>{console.log(d.text)}); // -> on word click print the labels' text
```

> Note that the callback has to follow D3 v6.0's callback signature:
> `callback(event, datum)`
> Check [D3 v6.0 migration guide](https://observablehq.com/@d3/d3v6-migration-guide#events) for more details

#### `WordCloud.setWordMouseover(callbackMouseover, callbackMouseout)`

Sets the callbacks for mouse-over/out events on the wordcloud's labels.
```javascript
wordcloud.setWordMouseover((e,d)=>{console.log(d.text+' over')}, (e,d)=>{console.log(d.text+' out')}); // -> on word click print the labels' text + over/out
```

> Note that the callbacks have to follow D3 v6.0's callback signature:
> `callback(event, datum)`
> Check [D3 v6.0 migration guide](https://observablehq.com/@d3/d3v6-migration-guide#events) for more details

#### `WordCloud.render(labelsData)`

Renders the wordcloud using the provided `labelsData`. Label data can be accessed from topic's data: `topic.labels`.
```javascript
function bubbleClickCallback(e,d){
    wordcloud.render(d.labels);
}
bubblemap.setBubbleClick(bubbleClickCallback); // -> upon clicking on a bubble in bubblemap, will render the associated topic's labels in the wordcloud
```

#### `WordCloud.highlightTexts(words)`

Provided a list of words, will highlight the associated labels using the CSS class `highlighted`.
```javascript
wordcloud.highlightTexts(['label1','label2']); // -> the words 'label1' and 'label2' will be marked as 'highlighted' in the wordcloud
```

#### `WordCloud.highlightTextsOpacity(words)`

Provided a list of words, will lower the opacity of every other words in the wordcloud, using the CSS class `lowerOpacity`.
```javascript
wordcloud.highlightTextsOpacity(['label1','label2']); // -> every words which are not 'label1' or 'label2' will be marked as 'lowerOpacity' in the wordcloud
```


### Trend Chart

The trend chart visualisation module renders date distribution data from the [Data Manager's trend features](#trend-features), itself working with data from the Topic Mapping Pipeline distribute topics module, when applied on dates.

A Trend Chart is instantiated using `tMap`'s `TrendChart` function. Like most page modules, it takes three parameters: a DOM `container`, and initial `width` and `height`. These parameters are typically returned by the [Page Manager](#page-manager).
```javascript
let PM = tMap.PageManager(...);
let trendchart = tMap.TrendChart(PM.panel4.c, PM.panel4.w, PM.panel4.h);
```

This module is built with [the visualisation API](#visualisation-api) and therefore has the same base methods.

> Note that all of the functions below return the visualisation module itself, unless specified otherwise.
> This allows you to chain this functions.

#### `TrendChart.setMarginLeft(value)`

Sets the left margin for the trend chart. This function is mostly useful to adjust the space for the axis labels.
```javascript
trendchart.setMarginLeft(30); // -> the left margin will now be 30 pixels
```

#### `TrendChart.setMarginBottom(value)`

Sets the bottom margin for the trend chart. This function is mostly useful to adjust the space for the axis labels.
```javascript
trendchart.setMarginBottom(20); // -> the left margin will now be 20 pixels
```

#### `TrendChart.setValueTicks([number [, tickFormat]])`

Allows you to the set the number and format of tick marks on the chart's continuous value axis. By default, there are 10 ticks with no specific format.
```javascript
trendchart.setValueTicks(6, '.1f'); // -> put 6 tick marks formated to be fixed 1 decimal with
```
Refer to [D3's number format module](https://github.com/d3/d3-format) for more details on formats.

#### `TrendChart.setDateTicks(inFormat [, outFormat])`

Allows you to set the format of tick marks on the chart's category axis, i.e. the dates. `inFormat` should be the date format in the data. `outFormat` allows you to set a different format for the tick marks, by default it will be the same as the format in the data.
```javascript
trendchart.setDateTicks('%Y-%m'); // -> expecting the date in the data to be like '2013-07', and will have the ticks as such
trendchart.setDateTicks('%Y-%m', '%b. %Y'); // -> expecting the date in the data to be like '2013-07', and will have the ticks like 'Jul. 2013'
```
Refer to [D3's time format module](https://github.com/d3/d3-time-format) for more details on time formats.

#### `TrendChart.setMaxValue(value)`

Sets the chart's maximum value on the value axis. Since the continuous scale is adjusted at every render, this allows you to keep the same scale (`0, maxValue`). The default maximum value is `-1`, which is interpreted as no maximum, i.e. use the next render maximum. 
```javascript
trendchart.setMaxValue(1); // -> the maximum value will always be 1, i.e. 100% if formated with '.0%'
```

#### `TrendChart.setTransition([duration [, delay]])`

Sets the duration and delay (per bar) values for transition animation on the trend chart. These values default to `100`ms for `duration` and `50`ms for delay. You can disable transitions by setting the duration value to `0`.
```javascript
trendchart.setTransition(200, 100); // -> sets the transitions to 200ms duration and 100ms delay (per bar)
```

#### `TrendChart.setTooltip(textFunction)`

Sets the function used to build the trend bars' tooltip text. If defined, this text function will be called with the bar's datum as parameter. You can set this text function to `null` in order to disable the text tooltip.
```javascript
trend.setTooltip(d=>`<b>${d.date}</b>: ${d.value}`); // trend bars' tooltip will print '<b>2018</b>: 0.32' for example.
```

#### `TrendChart.setTooltipChart(charFunction)`

Sets the function used to build the trend bars' tooltip chart. If defined, this chart function will be called with the tooltip's DOM container and the bar's datum as parameter. You can set this chart function to `null` in order to disable the chart tooltip.
```javascript
let DM = tMap.DataManager();
trendchart.setTooltipChart((t,d)=>{
    tMap.HorizontalBarChart(t, 200, 100)
        .render(DM.getMainTopicsDistrib(d.date));
}); // tredn bars' tooltip include an horizontal bar chart showing the bar's date/key field distribution.
```

#### `TrendChart.setBarClick(callback)`

Sets the callback for click events on the trend bars.
```javascript
trendchart.setBarClick((e,d)=>{console.log(d.key)}); // -> on bar click print the bar's key
```

> Note that the callback has to follow D3 v6.0's callback signature:
> `callback(event, datum)`
> Check [D3 v6.0 migration guide](https://observablehq.com/@d3/d3v6-migration-guide#events) for more details 

#### `TrendChart.render(trendDataSeries)`

Renders the trend chart using the provided trend data series (in the format: `[[{date,value}]]`). This type of data is typically obtained from the [Data Maneger's tren features](#trend-features). You can pass one or multiple series.
```javascript
let DM = tMap.DataManager();
let sumByYear = DM.timeFormatConverter('%d/%m/%y', '%Y'); // -> reduce the trend data by year
let trendRange = ['%d/%m/%y', '01/01/11', '01/01/20']; // -> get data between 2011 (inc.) and 2020 (exc.)

trendchart.render([DM.getMainTopicTrend('3', sumByYear, trendsRange)]);
// -> renders the trend data for the main topic '3'

trendchart.render([DM.getMainTopicTrend('3', sumByYear, trendsRange),
                   DM.getSubTopicTrend('11', sumByYear, trendsRange)]);
// -> renders the trend data for the main topic '3' and sub topic '11'
```

#### `TrendChart.selectBar([date])`

Sets the trend bar with key `date` as selected, using the CSS class `selected`. The parameter `date` is optional, not providing it, or setting it as `null`, will unselect any previously selected bar.
```javascript
trendchart.selectBar('2013'); // -> bar with date '2013' is marked as selected
trendchart.selectBar(); // -> every bar are unselected
```


### Bar Chart

The bar chart visualisation modules render distribution data from the [Data Manager's distributions features](#distribution-features), itself working with data from the Topic Mapping Pipeline distribute topics module.

There are two versions of bar charts: horizontal and vertical.

A Bar Chart is instantiated using `tMap`'s `HorizontalBarChart` or `VerticalBarChart` functions. Like most page modules, they take three parameters: a DOM `container`, and initial `width` and `height`. These parameters are typically returned by the [Page Manager](#page-manager).
```javascript
let PM = tMap.PageManager(...);
let barchat1 = tMap.HorizontalBarChart(PM.panel4.c, PM.panel4.w, PM.panel4.h);
let barchat2 = tMap.VerticalBarChart(PM.panel5.c, PM.panel5.w, PM.panel5.h);
```

These modules are built with [the visualisation API](#visualisation-api) and therefore have the same base methods.

> Note that all of the functions below return the visualisation module itself, unless specified otherwise.
> This allows you to chain this functions.

#### `BarChart.setMarginLeft(value)`

Sets the left margin for the bar chart. This function is mostly useful to adjust the space for the axis labels.
```javascript
barchart.setMarginLeft(30); // -> the left margin will now be 30 pixels
```

#### `BarChart.setMarginBottom(value)`

Sets the bottom margin for the bar chart. This function is mostly useful to adjust the space for the axis labels.
```javascript
barchart.setMarginBottom(20); // -> the left margin will now be 20 pixels
```

#### `BarChart.setTicks([number [, format]])`

Allows you to the set the number and format of tick marks on the charts' continuous axis. By default, there are 10 ticks with no specific format.
```javascript
barchart.setTicks(5, '.0%'); // -> put 5 tick marks formated to be percentages with no decimal points
```
Refer to [D3's number format module](https://github.com/d3/d3-format) for more details on formats.

#### `BarChart.setMaxValue(value)`

Sets the chart's maximum value on the continuous axis. Since the continuous scale is adjusted at every render, this allows you to keep the same scale (`0, maxValue`). The default maximum value is `-1`, which is interpreted as no maximum, i.e. use the next render maximum. 
```javascript
barchart.setMaxValue(1); // -> the maximum value will always be 1, i.e. 100% if formated with '.0%'
```

#### `BarChart.setTransition([duration [, delay]])`

Sets the duration and delay (per bar) values for transition animation on the bar chart. These values default to `100`ms for `duration` and `50`ms for delay. You can disable transitions by setting the duration value to `0`.
```javascript
barchart.setTransition(200, 100); // -> sets the transitions to 200ms duration and 100ms delay (per bar)
```

#### `BarChart.setTooltip(textFunction)`

Sets the function used to build the bars' tooltip text. If defined, this text function will be called with the bar's datum as parameter. You can set this text function to `null` in order to disable the text tooltip.
```javascript
barchart.setTooltip(d=>`<b>${d.key}</b>: ${d.value}`); // bars' tooltip will print '<b>A</b>: 0.32' for example.
```

#### `BarChart.setTooltipChart(charFunction)`

Sets the function used to build the bars' tooltip chart. If defined, this chart function will be called with the tooltip's DOM container and the bar's datum as parameter. You can set this chart function to `null` in order to disable the chart tooltip.
```javascript
let DM = tMap.DataManager();
barchart.setTooltipChart((t,d)=>{
    tMap.HorizontalBarChart(t, 200, 100)
        .render(DM.getMainTopicsDistrib(d.key));
}); // bars' tooltip include an horizontal bar chart showing the bar's key field distribution.
```

#### `BarChart.setBarClick(callback)`

Sets the callback for click events on the bars.
```javascript
barchart.setBarClick((e,d)=>{console.log(d.key)}); // -> on bar click print the bar's key
```

> Note that the callback has to follow D3 v6.0's callback signature:
> `callback(event, datum)`
> Check [D3 v6.0 migration guide](https://observablehq.com/@d3/d3v6-migration-guide#events) for more details 

#### `BarChart.render(distributionData)`

Renders the bar chart using the provided distribution data (in the format: `[{key,value}]`). This type of data is typically obtained from the [Data Maneger's distribution features](#distribution-features).
```javascript
let DM = tMap.DataManager();
barchart.render(DM.getMainTopicDistribEntry('4')); // -> renders the distribution for the main topic '4'
```

#### `BarChart.selectBar([key])`

Sets the bar with key `key` as selected, using the CSS class `selected`. The parameter `key` is optional, not providing it, or setting it as `null` will unselect any previously selected bar.
```javascript
barchart.selectBar('A'); // -> bar with key 'A' is marked as selected
barchart.selectBar(); // -> every bar are unselected
```


### Line Chart

The line chart visualisation module renders a set of data point with two scalar attributes (x and y). This chart is typically used to show the model loglikelihood data, which is currently embedded in the [floating menu module](#floating-menu).

A Line Chart is instantiated using `tMap`'s `LineChart` function. Like most page modules, it takes three parameters: a DOM `container`, and initial `width` and `height`. These parameters are typically returned by the [Page Manager](#page-manager).
```javascript
let PM = tMap.PageManager(...);
let lineChart = tMap.LineChart(PM.panel5.c, PM.panel5.w, PM.panel5.h);
```

This module is built with [the visualisation API](#visualisation-api) and therefore has the same base methods.

#### `LineChart.setMarginLeft(value)`

Sets the left margin for the line chart. This function is mostly useful to adjust the space for the axis labels.
```javascript
linechart.setMarginLeft(30); // -> the left margin will now be 30 pixels
```

#### `LineChart.setMarginBottom(value)`

Sets the bottom margin for the line chart. This function is mostly useful to adjust the space for the axis labels.
```javascript
linechart.setMarginBottom(20); // -> the bottom margin will now be 20 pixels
```

#### `LineChart.setXAxisName(name)`

Sets the horizontal axis name (x). This name is used when showing the tooltips for dots on the line chart. The default name is set to `'x'`.
```javascript
linechart.setXAxisName('Iteration'); // -> dot tooltip will display 'Iteration: 30' for example
```

#### `LineChart.setYAxisName(name)`

Sets the vertical axis name (y). This name is used when showing the tooltips for dots on the line chart. The default name is set to `'y'`.
```javascript
linechart.setYAxisName('Likelihood'); // -> dot tooltip will display 'Likelihood: 7.09' for example
```

#### `LineChart.setAxesNames(nameX, nameY)`

Combines the previous two functions. `nameX` will be used for the horizontal axis, and `nameY` for the vertical axis.
```javascript
linechart.setAxesNames('Iteration', 'Likelihood'); // -> dot tooltip will display 'Iteration: 30<br>Likelihood: 7.09' for example
```

#### `LineChart.setXTicks([number [, format]])`

Allows you to the set the number and format of tick marks on the chart's vertical axis (x). By default, there are 10 ticks with no specific format.
```javascript
linechart.setXTicks(5, '.0f'); // -> put 5 tick marks formated to be in fixed notation with no decimal points
```
Refer to [D3's number format module](https://github.com/d3/d3-format) for more details on formats.

#### `LineChart.setYTicks([number [, format]])`

Allows you to the set the number and format of tick marks on the chart's horizontal axis (y). By default, there are 10 ticks with no specific format.
```javascript
linechart.setXTicks(10, '.2e'); // -> put 10 tick marks formated to be in exponent notation with two decimal points
```
Refer to [D3's number format module](https://github.com/d3/d3-format) for more details on formats.

#### `LineChart.setTicks([numberX [, numberY [, formatX [, formatY]]]])`

Combines the previous two functions. `numberX` and `numberY` will be the number of ticks on the horizontal and vertical axes respectively. `formatX` and `formatY` will be the tick format on the horizontal and vertical axes respectively.
```javascript
linechart.setTicks(5, 10, '.0f', '.2e');
// -> put 5 tick marks formated to be in fixed notation with no decimal points on the horizontal axis
//    and put 10 tick marks formated to be in exponent notation with two decimal points on the vertical axis
```

#### `LineChart.render(dataset)`

Renders the line chart using the provided dataset, which assumes the following format: `[{x,y}]`.
```javascript
let data = [{x:10,y:3.78},{x:20,y:4.789},{x:30,y:6.098}];
linechart.render(data); // -> renders data
```


## HTML Panel Modules

The HTML panel modules are view panels with an HTML structure (e.g. table, div, etc.). They all share [the same base API](#panel-api). Currently, the Topic Mapping Interface comprises the following HTML panel modules:
- [Document Table](#document-table)
- [Document Viewer](#document-viewer)

### Panel API

The HTML panel modules are all built from the same base module, meaning that they share a common base API.

> Note that all of the functions below return the panel module itself, unless specified otherwise.
> This allows you to chain this functions.

#### `Panel.setWidth(value)`

Sets the panel width, and automatically adjust its internal elements.
```javascript
let p = tMap.somePanel();
p.setWidth(600); // -> the panel width to 600px
```

#### `Panel.setHeight(value)`

Sets the panel height, and automatically adjust its internal elements.
```javascript
let p = tMap.somePanel();
p.setHeight(300); // -> the panel height to 300px
```

#### `Panel.setSize(width, height)`

Sets the panel's width and height, and automatically adjust its internal elements.
```javascript
let p = tMap.somePanel();
p.setSize(600,300); // -> the panel width to 600px and height to 300px
```

#### `Panel.toggleBorder([boolean])`

Toggles a border around the panel module. The `boolean` parameter lets you specify which state you want: `true` = on, and `false` = off. It is optional will default to the opposite of the visualisation current state. Note that the visualisation border is on by default.
```javascript
let p = tMap.somePanel(); // -> the panel border is on
p.toggleBorder(true); // -> turns on the panel border (no effect)
p.toggleBorder(false); // -> removes the panel border
p.toggleBorder(); // -> turns on the panel border
p.toggleBorder(); // -> turns off the panel border
```

#### `Panel.toggleTitle([text])`

Toggles a title on the visualisation. If `text` is specified, toggles the title on with this text, otherwise toggles the title off. The title is always placed on top of the panel.
```javascript
let p = tMap.somePanel();
p.toggleTitle('Panel A'); // -> puts 'Panel A' as the top of the panel
p.toggleTitle(); // -> removes 'Panel A' from the panel
```

#### `Panel.addDefault(string, [, size [, blinking]])`

Puts a message, `string`, at the center of the visualisation. `size` lets you specify the message size in `em`, defaults to 1. `blinking` lets you specify if you want the message to blink `true` or not `false` (default), for example when loading data.
```javascript
let p = tMap.somePanel();
p.addDefaultText('Loading data', 1.5, true); // -> large blinking text saying 'Loading data'
``` 
Note that any message printed this way will be automatically removed once the panel renders data.


### Document Table

The document table panel module renders a list of document from `mainModel` or `subModel` files, produced by the Topic Mapping Pipeline model export module.

A Document Table is instantiated using `tMap`'s `DocTable` function. Like most page modules, it takes three parameters: a DOM `container`, and initial `width` and `height`. These parameters are typically returned by the [Page Manager](#page-manager).
```javascript
let PM = tMap.PageManager(...);
let docTable = tMap.DocTable(PM.panel3.c, PM.panel3.w, PM.panel3.h);
```

This module is built with [the HTML panel API](#panel-api) and therefore has the same methods.

> Note that all of the functions below return the panel module itself, unless specified otherwise.
> This allows you to chain this functions.

#### `DocTable.setMinRowHeight([value])`

Lets you set the minimum height of rows in the table. The default minimum is set to one eleventh of the table height.
```javascript
docTable.setMinRowHeight(20); // -> the table's row is set to 20px
docTable.setMinRowHeight(); // -> the table's row is set to an eleventh of the table's height
```

#### `DocTable.setColumnsInfo([columns])

Lets you set the data for the table columns. `columns` should be an array, each entry containing the data for one column. For each column you can specify:
- `title`, the column header, defaults to `''`;
- `tooltip`, the tooltip text callback for the column's cells, defaults to `null`;
- `tooltip`, the tooltip chart callback for the column's cells, defaults to `null`;
- `accessor`, the value accessor function  for the column's cells, defaults to `()=>{}`;
- `mouseover`, the mouseover callback for the column's cells, defaults to `()=>{}`;
- `mouseout`, the mouseout callback for the column's cells, defaults to `()=>{}`;
- `click`, the click callback for the column's cells, defaults to `()=>{}`;
- `align`, the alignment style for the column's cells, defaults to `'left'`;
- `decoration`, the text decoration style for the column's cells, defaults to `'none'`; and
- `cursor`, the cursor style for the column's cells, defaults to `'default'`.

```javascript
let tableTooltip = d => {
    let fields = [];
    fields.push(`Word Count: ${d.wordCount}`);
    fields.push(`Relevance: ${Math.floor(d.weight*100)}%`);
    return fields.join(' - ');
}; // -> set a tooltip callback with the document's word count and weight, e.g. "Word Count: 104 - Relevance 30%"
let selectDoc = (e,d)=>{
    console.log(d);
    //...
}; // -> set a click callback printing the document data
let redirect = (e,d)=>{
    window.open(d.link, '_blank');
}; // -> set a click callback opening a new browser window to the document link
let formatDate = d=>{
    return format(d, '%b. %Y');
}; // -> set a function to format date values
docTable.setColumnsInfo([
    // set a title column, with tooltip and click callbacks
    {title:'Title',accessor:d=>d.title,tooltip:tableTooltip,click:selectDoc},
    // set an authors column, with tooltip and click callbacks
    {title:'Authors',accessor:d=>d.authors,tooltip:tableTooltip,click:selectDoc},
    // set a date column, showing the document's date formated, with tooltip and click callbacks
    {title:'Date',accessor:d=>formatDate(d.date),tooltip:tableTooltip,click:selectDoc},
    // set a link column, just showin 'link' underline, with tooltip and a redirect click callback
    {title:'Link',accessor:()=>'link',decoration:'underline',tooltip:tableTooltip,click:redirect}
    ]);
```

> Note that the click, mouseover, and mouseout callbacks have to follow D3 v6.0's callback signature:
> `callback(event, datum)`
> In this instance, `datum` refers to the row data.
> Check [D3 v6.0 migration guide](https://observablehq.com/@d3/d3v6-migration-guide#events) for more details
> 
> The tooltip, tooltipChart, and accessor functions take the row data as unique argument. 

#### `DocTable.rowsFilter([options [, callback [, text]]])`

Lets you set filter options, on top of the table, for the table rows. `options` is the list of of options available for the filter, it defaults to `[]`, which completely removes the filter. `callback` is the callback function for clicks on the filter options. `text` is the text to display before the filter options for context, it defaults to `''`. On render, the filter will also print the number of rows in the table.
```javascript
docTable.rowsFilter([20,60,90],(e,d)=>{docTable.render(DM.getTableRows(50, d2=>Math.floor(d2.weight*100)>=d),d)},'Min Relevance'); // -> dislay 'Min Relevance: 20 60 90' on top of the table
// if the user clicks on 60, the table will have up to 50 rows with a document weight greater or equal to 60%

docTable.rowsFilter([10,20,50],(e,d)=>{docTable.render(DM.getTableRows(d),d)},'N Docs'); // -> dislay 'N Docs: 10 20 50' on top of the table
// if the user clicks on 20, the table will have up to 20 rows
```

> Note that the click callback has to follow D3 v6.0's callback signature:
> `callback(event, datum)`
> Check [D3 v6.0 migration guide](https://observablehq.com/@d3/d3v6-migration-guide#events) for more details


#### `DocTable.render(dataset [,filter])`

Renders the table using `dataset` to fill its rows. Each row will render its cells according to the columns info set previously. `filter` is an optional parameter informing the module if a filter option was used (to highlight it).
```javascript
let DM = tMap.DataManager();
DM.setTableRowsMainTopic('4'); // -> set the table rows to the top documents of main topic 4
docTable.render(DM.getTableRows(50)); // -> render the table using the top 50 documents set in data manager
``` 

#### `DocTable.highlightDocs(docIds)`

Mark the table rows as highlighted (CSS class), if their corresponding document id is part of the `docIds` list.
```javascript
docTable.highlightDocs(['34','56','87']); // -> mark documents 34, 56, and 87 as highlighted
```

#### `DocTable.fadeDocs(docIds)`

Mark the table rows as faded (CSS class), if their corresponding document id is part of the `docIds` list.
```javascript
docTable.highlightDocs(['21','35','67']); // -> mark documents 21, 35, and 67 as faded
```


### Document Viewer

The document viewer panel module renders a document's data from `mainModel` or `subModel` files, produced by the Topic Mapping Pipeline model export module.

A Document Viewer is instantiated using `tMap`'s `DocViewer` function. Like most page modules, it takes three parameters: a DOM `container`, and initial `width` and `height`. These parameters are typically returned by the [Page Manager](#page-manager).
```javascript
let PM = tMap.PageManager(...);
let docViewer = tMap.DocViewer(PM.panel4.c, PM.panel4.w, PM.panel4.h);
```

This module is built with [the HTML panel API](#panel-api) and therefore has the same methods.

> Note that all of the functions below return the panel module itself, unless specified otherwise.
> This allows you to chain this functions.

#### `DocViewer.setFields([fields])`

Lets you specify which document fields the document viewer should display. `fields` is an optional list, it defaults to `null`, meaning to desired fields, and therefore the viewer will disply all document fields in any order. The `fields` list can take multiple forms:
- a list of string, corresponding to the fields' keys (and order of fields) you want displayed for the document data;
- a list of lists, corresponding to the fields and order of fields you wan displayed for the document data:
    - with a first string item: the field's key in the document data;
    - with an optional second item: the key value you want displayed on the viewer;
    - with an optional third item: a transform function for the field's value (e.g. number format).
```javascript
docViewer.setFields(['title','authors',['university','institution',d=>`University of ${d}`],'abstract',['money','grant',d=>format(d,'£.2f')]);
// -> in the doc viewer display the document's title, authors, university, abstract and money, in that order
// university should be renamed institution, and the field value should have 'University of ' prepended to it
//  money should be renamed grant, and the field value should be formatted to a 2 decimal fixed value with a £ prefix
```

#### `DocViewer.render(docData)`

Renders the document viewer with the provided document data.
```javascript
docTable.setColumnsInfo([{
    title:Title,
    accessor:d=>d.docData.title,
    click(e,d)=>{
        docViewer.render(d.docData)
    }
}])
// -> in the document table, show one column for the docuemnts' title. Upon clicking on a title, render the document viewer with the corresponding document data.
```


## Control Modules

The control modules provide further interactivity features with the view panels. The Topic Mapping Interface currently has the following control modules:
- [Floating Menu](#floating-menu)
- [Search Box](#search-box)
- [Dropdown Filter](#dropdown-filter)


### Floating Menu

The floating menu module allows you to add infromation/functionalities which aren't directly linked to the views (e.g. model information modal, external link, download modal, etc.).

A Floating Menu is instantiated using `tMap`'s `Menu` function. It takes two parameters: a DOM `container`, and an initial button `height`. These parameters are typically returned by the [Page Manager](#page-manager). Note that you can simply pass `'body'` as the DOM `container`, in which case the menu will be displayed on the top-left cormer of the page.
```javascript
let PM = tMap.PageManager(...);
let menu = tMap.Menu(PM.control3.c, PM.control3.h);
```

> Note that all of the functions below return the panel module itself, unless specified otherwise.
> This allows you to chain this functions.

#### `Menu.setSize(value)`

Sets the height (and width) of the menu's button. Note that the button size cannot be smaller than `30px`.
```javascript
menu.setSize(50); // -> the menu's button size will be 50px
```

#### `Menu.addShare(urlCallback)`

Adds an item to the menu to open a modal with a link to the current application view. `urlCallback` will be called to generate the url.
```javascript
let SM = tMap.StateManager();
menu.addShare(()=>{return SM.buildURL();}); // -> adds an menu item that will trigger a modal with a link to share the application in its current state
```

#### `Menu.addScreenshot(selector [, timeout])`

Adds an item to the menu that will capture a screenshot of the application, and launch a save dialog. `selector` should point to the DOM element from which the capture is made, e.g. `'body'` or `'#app'`. `timeout` is the delay afterwhich the capture will be made (e.g. to allow for the menu to be closed), it defaults to 1000ms (1s).
```javascript
menu.addScreenshot('#app'); // -> adds a menu item that will capture the page elements under '#app' and launch a save dialog
```

#### `Menu.addDownload(downloadData)`

Adds an item to the menu that will display a modal with a list of links to data files, making them available for download. `downloadData` is a list of `name` and `url` pairs, `name` being the link's text in the modal, and `url` the address of the data file.
```javascript
menu.addDownload([{name:'Model data',url:'./data/model.csv'},{name:'Model statistics',url:'./data/model_stats.json'}]); // -> adds a menu item that will trigger a modal with two links, one for the model data csv file, one for the model statistic json file.
``` 

#### `Menu.addLink(text, url [, newTab])`

Adds a hyperlink item to the menu. `text` is the link's text, and `url` is the link address. `newTab` is an option allowing you to specify if the link should be open in the same browser tab (`false`) or a new browser tab (`true`, default).
```javascript
menu.addLink('Other map', './otherMap.html', false); // -> adds a link to another topic map application, that will open in the same tab
menu.addLink('Contact', '../contact.html'); // -> adds a link to a contact page, that will open in a new tab
```

#### `Menu.addCharts(title, chartCallbacks)`

Adds an item to the menu that will trigger a modal display one or more chart. `title` lets you set the modal title. `chartCallbacks` is a set of callback functions that should instantiate and render charts. These callbacks will be called using three parameter: the container for the chart inside the modal, the available width, and the available height. Using these dimensions for the chart will ensure a good fit in the modal.
```javascript
menu.addCharts('Model Stats', [
    (c,w,h)=>{
        tMap.LineChart(c,w,h)
            .toggleTitle('Stat A')
            .setAxesNames('Iterations', 'Stat A')
            .render(statAData); // -> renders a line chart of stat A data
    },
    (c,w,h)=>{
        tMap.LineChart(c,w,h)
            .toggleTitle('Stat B')
            .setAxesNames('Iterations', 'Stat B')
            .render(statBData); // -> renders a line chart of stat B data
    }
]);
```

#### `Menu.addModelInfo(mainMetadata [, subMetadata [, extraLines]])`

Adds an item to the menu that will trigger a modal with details about the model(s) extracted from its(their) metadata. `mainMetadata` is the main model's metadata, `subMetadata` is the optional sub model's metadata (defaults to `null`). `extraLines` let you specify (as HTML strings) any custom paragraphs you would like appended.
```javascript
let DM = tMap.DataManager();
menu.addModelInfo(DM.getMainModelMetadata(), DM.getSubModelMetadata(), ['Additional <b>important</b> information.']); // -> adds a menu item triggering a modal showing the main and sub models metadata, along with an custom extra paragraph
```

#### `Menu.addModal(title, content)`

Adds an item to the menu that will trigger a modal with custom `title` and `content` (in HTML).
```javascript
menu.addModal('Contact', '<p>You can contact us <a href="mailto:contact@domain.com">here</a>.</p>'); // -> adds a menu item that triggers a modal showing a contact link
```


### Search Box

The search box module allows you to coordinate the search and highlight of labels accross the different view panels.

A Search Box is instantiated using `tMap`'s `Search` function. Like most page modules, it takes three parameters: a DOM `container`, and initial `width` and `height`. These parameters are typically returned by the [Page Manager](#page-manager).
```javascript
let PM = tMap.PageManager(...);
let search = tMap.Search(PM.control1.c, PM.control1.w, PM.control1.h);
```

> Note that all of the functions below return the panel module itself, unless specified otherwise.
> This allows you to chain this functions.

#### `Search.setWidth(value)`

Lets you set the width of the search box.
```javascript
search.setWidth(150); // -> search box is now 150px wide
```

#### `Search.setHeight(value)`

Lets you set the height of the search box.
```javascript
search.setWidth(80); // -> search box is now 80px tall
```

#### `Search.setSize(width, height)`

Lets you set the width and height of the search box together.
```javascript
search.setSize(200, 90); // -> search box is now 200px wide and 90px tall
```

#### `Search.setPlaceholder(string)`

Lets you set the placeholder text inside the search input. By default the placeholder is set to `'Search labels...'`.
```javascript
search.setPlaceholder('Search topics'); // -> search input placeholder is now 'Search topics'
```

#### `Search.setSearchCB(callback)`

Lets you set the callback function that will be called upon any input in the search. This callback function takes one argument: the current text in the search input (in lower case).
```javascript
let SM = tMap.StateManager();
let DM = tMap.DataManager();
search.setSearchCB(str=>{
    let query = str.length > 0 ? str : null; // -> checks the search value and set it to null if empty
    SM.state('search', query); // -> sets the search state to the search value
    // ...
    DM.setSearchTerm(SM.state('search')); // -> use state manager to set the search value in the data manager, e.g. for later retrieval of topic id
})
```

#### `Search.setValue(string)`

Lets you manually set the search input value.
```javascript
let SM = tMap.StateManager();
search.setValue(SM.state('search')); // -> sets the search input value to the state manager's search state
```

> This triggers the input event, and by extenstion calls the callback function

#### `Search.getValue()`

Returns the current search input value.
```javascript
console.log(search.getValue()); // -> returns '' (i.e. empty search);
let SM = tMap.StateManager();
search.setValue(SM.state('search'));
console.log(search.getValue()); // -> returns the updated search value, e.g. 'label1'
```


### Dropdown Filter

The dropdown filter module allows you to select a filter value for the topic maps' opacities.

A Dropdown Filter is instantiated using `tMap`'s `Dropdown` function. Like most page modules, it takes three parameters: a DOM `container`, and initial `width` and `height`. These parameters are typically returned by the [Page Manager](#page-manager).
```javascript
let PM = tMap.PageManager(...);
let dropdown = tMap.Dropdown(PM.control2.c, PM.control2.w, PM.control2.h);
```

> Note that all of the functions below return the panel module itself, unless specified otherwise.
> This allows you to chain this functions.

#### `Dropdown.setWidth(value)`

Lets you set the width of the dropdown.
```javascript
dropdown.setWidth(150); // -> dropdown is now 150px wide
```

#### `Dropdown.setHeight(value)`

Lets you set the height of the dropdown.
```javascript
dropdown.setWidth(80); // -> dropdown is now 80px tall
```

#### `Dropdown.setSize(width, height)`

Lets you set the width and height of the dropdown together.
```javascript
dropdown.setSize(200, 90); // -> dropdown is now 200px wide and 90px tall
```

#### `Dropdown.setOptions(values)`

Lets you set the dropdown options. `values` takes the form of a list of text (what is displayed on the page) and value (what is used under the hood) pairs. These pairs are typically returned by the Data Manager [`getDistributionLabels` function](#datamanagergetdistributionlabelstexttransform).

> This triggers the change event, and by extenstion calls the callback function

```javascript
let DM = tMap.DataManager();
// get DM to have distribution data
let distribValues = DM.getDistributionLabels();
distribValues.unshift({text: 'All', value: 'all'}); // -> prepend an entry for no filter
dropdown.setOptions(distribValues); // -> dropdown now has topic distribution labels as options
```

#### `Dropdown.setSelectCB(callback)`

Lets you set the callback function for change event on the option selection. `callback` allows one parameter: the `value` of the option selected.
```javascript
let SM = tMap.StateManager();
dropdown.setSelectCB(value=>{
    SM.state('distrib', value); // -> update the state manager with the new distribution filter value
    // ... set the opacities of topic maps
})
```

#### `Dropdown.setSelected(value)`

Lets you programmatically select one of the dropdown option based on its `value`.

> This triggers the change event, and by extenstion calls the callback function

```javascript
dropdown.setSelected('all'); // -> selects the option with value 'all'
```

#### `Dropdown.getSelected()`

Returns the data (text/value pair) of the currently selected option in the dropdown.
```javascript
dropdown.setSelected('all'); // -> selects the option with value 'all'
dropdown.getSelected('all'); // -> returns {text:'All', value:'all'}
```


## Other Utilities

`tMap` also integrates a few utilities:
- [Format Functions](#format-functions)
- [Information Function](#information-function)

### Format Functions

The format functions are mostly just accessors for D3's [number](https://github.com/d3/d3-format) and [date](https://github.com/d3/d3-time-format) formatting modules.

#### `tMap.formatNumber(number, format)`

Returns `number` formated using the provided `format`. Typically useful when setting up tooltip functions, or table cells.
```javascript
console.log(tMap.formatNumber(23459.57, ',d')); // -> prints '23,460'
```

#### `tMap.formatDate(date, format)`

Returns `date` formatted using the provided `format`. `date` must be a javascript Date object.
```javascript
console.log(tMap.formatDate(new Date(), '%b. %Y')); // prints 'Feb. 2021'
```

#### `tMap.parseDate(date, format)`

Returns a javascript Date object, by parsing `date` using the provided `format`.
```javascript
console.log(tMap.parseDate('Feb. 2021', '%b. %Y')); // -> prints 'Mon Feb 01 2021 00:00:00 GMT+0000 (Greenwich Mean Time)'
```

#### `tMap.convertDate(date, inFormat, outFormat)`

Returns the provided `date` string, in the format `inFormat`, now formated with `outFormat`.
```javascript
console.log(tMap.convertDate('Feb. 2021', '%b. %Y', '%Y-%m-%d')); // -> prints '2021-02-01'
``` 

#### `tMap.dateConverter(inFormat, outFormat)`

Returns a date converter functions, taing date in the format `inFormat`, and returning them in the format `outFormat`. 
```javascript
let f = tMap.dateConverter('%b. %Y', '%Y-%m-%d');
console.log(f('Feb. 2021')); // -> prints '2021-02-01'
```

This function is duplicated in the [Data Manager's trend features](#datamanagertimeformatconverterinformat-outformat).

### Information Function

There is only one information function currently implemented.

#### `tMap.aboutTopicMapping([docType [, hasTable [, topicSize]]])`

Returns an HTML string providing background detail and references about topic modelling and the Topic Mapping applications. `docType` lets you specify what type of documents are used in your specific case (e.g. `'grant abstracts'`), it defaults to `'documents'`. `hasTable` is a boolean that lets you insert details about the Document Table, it defaults to `false` (i.e. no detail). `topicSize` lets you customise the value used to estimate the size of topics on Bubble Maps (e.g. `'total value of grants'`), it defaults to `'total number of documents'`.
```javascript
let menu = tMap.Menu('body', 50); // -> instantiate a floating menu
menu.addModal('About', tMap.aboutTopicMapping()); // -> adds an option to the floating menu to display an 'About' modal with info about topic mapping
```


## Styles

The modules' and page's styles are already predefined and set to work with the scripts rendering them. It is however possible to overwrite some of these styles individually inside a `main.css` file loaded by your HTML document.

Colors and fonts values are however used throughout the modules to ensure consistency. These values can be globally set using the CSS `:root` property:
```css
:root{
    --primary-color: #d65076;
    --primary-color-dark: #ad4965;
    --primary-color-light: #f7e7eb;
    --action-color: #d65076;
    --color-black: #333333;
    --color-dark-grey: #4C4C4C;
    --color-grey: #787878;
    --color-light-grey: #989898;
    --color-lighter-grey: #E3E5E5;
    --color-white: #FEFFFF;

    --color-success: #4CAF50;
    --color-danger: #F44336;
    --color-warning: #FFC107;
    --color-info: #03A9F4;

    --title-font: 'Raleway', sans-serif;
    --text-font: 'Open Sans', sans-serif;
}
```


---

This work is licensed under a [Creative Commons Attribution 4.0 International
License][cc-by-nc].

[![CC BY-NC 4.0][cc-by-nc-image]][cc-by-nc]

[cc-by-nc]: http://creativecommons.org/licenses/by-nc/4.0/
[cc-by-nc-image]: https://i.creativecommons.org/l/by-nc/4.0/88x31.png
[cc-by-nc-shield]: https://img.shields.io/badge/License-CC%20BY--NC%204.0-lightgrey.svg
